<!--
Page Publique - Villa √† Vendre Marrakech

Page de pr√©sentation compl√®te d'une villa de luxe √† Marrakech.
Optimis√©e pour le SEO avec m√©ta-tags complets, Open Graph, Twitter Cards,
et Schema.org JSON-LD pour un r√©f√©rencement optimal sur Google.

Fonctionnalit√©s:
- Design responsive luxueux avec gradient or-turquoise
- Galerie photos en plein √©cran avec navigation
- Sections organis√©es: images, caract√©ristiques, √©quipements, investissement, contact
- M√©ta-tags SEO complets pour Google, Facebook, Twitter
- Schema.org RealEstateListing pour rich snippets Google
- Boutons d'appel (WhatsApp, email, t√©l√©phone)
- Design th√®me clair moderne avec effets de lumi√®re

SEO:
- Title et description dynamiques bas√©s sur les donn√©es de la villa
- Meta keywords cibl√©s (villa marrakech, immobilier luxe, etc.)
- Open Graph pour partage Facebook/LinkedIn optimal
- Twitter Cards pour aper√ßus riches
- Schema.org JSON-LD pour rich results Google
- Balises canoniques et robots

D√©velopp√© par: MOA Digital Agency LLC
D√©veloppeur: Aisance KALONJI
Email: moa@myoneart.com
Web: www.myoneart.com
-->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ========== SEO META TAGS ========== -->
    <title>{% if villa %}{{ villa.title }} - Villa √† Vendre Marrakech | villaavendremarrakech.com{% else %}Villa √† Vendre Marrakech - Immobilier de Luxe | villaavendremarrakech.com{% endif %}</title>
    <meta name="description" content="{% if villa %}{{ villa.description[:155] }}... Villa de prestige √† vendre √† {{ villa.location }}, {{ '{:,.0f}'.format(villa.price).replace(',', ' ') }} ‚Ç¨. {% endif %}D√©couvrez nos villas de luxe √† Marrakech. Immobilier haut de gamme avec piscine, jardin et finitions premium.">
    <meta name="keywords" content="villa √† vendre marrakech, villa de luxe marrakech, immobilier marrakech, achat villa marrakech, propri√©t√© de prestige marrakech, maison √† vendre marrakech, villa avec piscine marrakech, immobilier de luxe maroc, investissement immobilier marrakech, villa moderne marrakech, villa traditionnelle marrakech, riad √† vendre marrakech, {% if villa %}{{ villa.location }}, {{ villa.bedrooms }} chambres{% endif %}">
    <meta name="author" content="villaavendremarrakech.com">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="language" content="fr">
    <meta name="geo.region" content="MA-15">
    <meta name="geo.placename" content="Marrakech">
    <link rel="canonical" href="https://villaavendremarrakech.com/">
    
    <!-- ========== OPEN GRAPH / FACEBOOK ========== -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://villaavendremarrakech.com/">
    <meta property="og:title" content="{% if villa %}{{ villa.title }} - Villa √† Vendre Marrakech{% else %}Villa √† Vendre Marrakech - Immobilier de Luxe{% endif %}">
    <meta property="og:description" content="{% if villa %}Villa de prestige √† {{ villa.location }}, {{ '{:,.0f}'.format(villa.price).replace(',', ' ') }} ‚Ç¨. {{ villa.bedrooms }} chambres, {{ villa.area }} m¬≤. {% endif %}D√©couvrez nos villas d'exception √† Marrakech.">
    <meta property="og:image" content="{% if villa and villa.get_images_list() %}https://villaavendremarrakech.com/static/uploads/{{ villa.get_images_list()[0] }}{% else %}https://villaavendremarrakech.com/static/og-default.jpg{% endif %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:site_name" content="Villa √† Vendre Marrakech">
    
    <!-- ========== TWITTER CARD ========== -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://villaavendremarrakech.com/">
    <meta name="twitter:title" content="{% if villa %}{{ villa.title }} - Villa √† Vendre Marrakech{% else %}Villa √† Vendre Marrakech - Immobilier de Luxe{% endif %}">
    <meta name="twitter:description" content="{% if villa %}Villa de prestige √† {{ villa.location }}, {{ '{:,.0f}'.format(villa.price).replace(',', ' ') }} ‚Ç¨{% endif %}">
    <meta name="twitter:image" content="{% if villa and villa.get_images_list() %}https://villaavendremarrakech.com/static/uploads/{{ villa.get_images_list()[0] }}{% else %}https://villaavendremarrakech.com/static/og-default.jpg{% endif %}">
    
    {% if villa %}
    <!-- ========== SCHEMA.ORG JSON-LD POUR RICH SNIPPETS GOOGLE ========== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "RealEstateListing",
      "name": "{{ villa.title }}",
      "description": "{{ villa.description[:500] }}",
      "url": "https://villaavendremarrakech.com/",
      "image": [
        {% for img in villa.get_images_list()[:5] %}
        "https://villaavendremarrakech.com/static/uploads/{{ img }}"{% if not loop.last %},{% endif %}
        {% endfor %}
      ],
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "{{ villa.location }}",
        "addressRegion": "Marrakech-Safi",
        "addressCountry": "MA"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": "31.6295",
        "longitude": "-7.9811"
      },
      "offers": {
        "@type": "Offer",
        "price": "{{ villa.price }}",
        "priceCurrency": "EUR",
        "availability": "https://schema.org/InStock",
        "priceValidUntil": "{{ (villa.created_at.year + 1)|string }}-12-31"
      },
      "numberOfRooms": "{{ villa.bedrooms }}",
      "numberOfBathroomsTotal": "{{ villa.bathrooms }}",
      "floorSize": {
        "@type": "QuantitativeValue",
        "value": "{{ villa.area }}",
        "unitCode": "MTK"
      },
      {% if villa.land_area %}
      "additionalProperty": {
        "@type": "PropertyValue",
        "name": "Surface du terrain",
        "value": "{{ villa.land_area }} m¬≤"
      },
      {% endif %}
      "telephone": "{{ villa.contact_phone }}",
      "email": "{{ villa.contact_email }}"
    }
    </script>
    
    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "RealEstateAgent",
      "name": "Villa √† Vendre Marrakech",
      "url": "https://villaavendremarrakech.com",
      "logo": "https://villaavendremarrakech.com/static/logo.png",
      "description": "Agence immobili√®re sp√©cialis√©e dans la vente de villas de luxe et propri√©t√©s de prestige √† Marrakech",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Marrakech",
        "addressCountry": "MA"
      },
      "telephone": "{{ villa.contact_phone }}",
      "email": "{{ villa.contact_email }}",
      "areaServed": {
        "@type": "City",
        "name": "Marrakech"
      }
    }
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Accueil",
          "item": "https://villaavendremarrakech.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "{{ villa.title }}",
          "item": "https://villaavendremarrakech.com/"
        }
      ]
    }
    </script>
    {% endif %}
    
    <!-- ========== FEUILLE DE STYLE ========== -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- ========== PAGE PUBLIQUE VILLA DE LUXE ========== -->
    {% if villa %}
    
    <!-- Hero Slider avec 3 Photos -->
    <section class="hero-modern">
        <div class="hero-slider">
            {% for img in villa.get_images_list()[:3] %}
            <div class="hero-slide {% if loop.first %}active{% endif %}">
                <img src="/static/uploads/{{ img }}" alt="Villa de luxe √† vendre √† {{ villa.location }}, Marrakech - Photo {{ loop.index }} - {{ villa.title }}">
            </div>
            {% endfor %}
        </div>
        <div class="hero-overlay-modern"></div>
        <div class="hero-content-modern">
            <h1>{{ villa.title }}</h1>
            <p class="subtitle-large">D√©couvrez cette villa d'exception √† Marrakech</p>
            <div class="hero-search-bar">
                <div class="search-item">
                    <span class="search-label">Localisation</span>
                    <span class="search-value">üìç {{ villa.location }}</span>
                </div>
                <div class="search-item">
                    <span class="search-label">Prix</span>
                    <span class="search-value">{{ '{:,.0f}'.format(villa.price).replace(',', ' ') }} ‚Ç¨</span>
                </div>
                {% set whatsapp_number = villa.contact_phone.replace('+', '').replace(' ', '').replace('-', '') if villa.contact_phone else '' %}
                {% set site_url = request.url_root %}
                {% set whatsapp_message = "Bonjour, je souhaite prendre rendez-vous pour visiter la villa " ~ villa.title ~ " et obtenir plus d'informations. Lien: " ~ site_url %}
                <a href="https://wa.me/{{ whatsapp_number }}?text={{ whatsapp_message | urlencode }}" target="_blank" class="btn-search">
                    Nous Contacter
                </a>
            </div>
        </div>
        <!-- D√©grad√© de transition vers stats -->
        <div class="hero-gradient-transition"></div>
    </section>

    <!-- Quick Stats -->
    <section class="quick-stats">
        <div class="container">
            <div class="stats-grid">
                {% if villa.terrain_area %}
                <div class="stat-item">
                    <div class="stat-icon">üèûÔ∏è</div>
                    <div class="stat-value">{{ '{:,}'.format(villa.terrain_area).replace(',', ' ') }} m¬≤</div>
                    <div class="stat-label">Terrain</div>
                </div>
                {% endif %}
                {% if villa.built_area %}
                <div class="stat-item">
                    <div class="stat-icon">üè†</div>
                    <div class="stat-value">{{ '{:,}'.format(villa.built_area).replace(',', ' ') }} m¬≤</div>
                    <div class="stat-label">Surface B√¢tie</div>
                </div>
                {% endif %}
                {% if villa.bedrooms %}
                <div class="stat-item">
                    <div class="stat-icon">üõèÔ∏è</div>
                    <div class="stat-value">{{ villa.bedrooms }}</div>
                    <div class="stat-label">Chambres</div>
                </div>
                {% endif %}
                {% if villa.pool_size %}
                <div class="stat-item">
                    <div class="stat-icon">üèä</div>
                    <div class="stat-value">{{ villa.pool_size }}</div>
                    <div class="stat-label">Piscine</div>
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Description avec 3 Images -->
    {% if villa.description %}
    <section class="content-image-section">
        <div class="container-wide">
            <div class="content-image-grid">
                <div class="content-block">
                    <h2 class="section-title-left">Une Villa d'Exception</h2>
                    <div class="text-content">{{ villa.description }}</div>
                    
                    {% set whatsapp_number = villa.contact_phone.replace('+', '').replace(' ', '').replace('-', '') if villa.contact_phone else '' %}
                    {% set site_url = request.url_root %}
                    {% set whatsapp_message = "Bonjour, je souhaite prendre rendez-vous pour visiter la villa " ~ villa.title ~ " et obtenir plus d'informations. Lien: " ~ site_url %}
                    
                    <a href="https://wa.me/{{ whatsapp_number }}?text={{ whatsapp_message | urlencode }}" target="_blank" class="btn-description">
                        üì± Prendre Rendez-vous sur WhatsApp
                    </a>
                </div>
                <div class="image-block-triple">
                    {% if villa.get_images_list()|length > 3 %}
                    <div class="triple-img-main">
                        <img src="/static/uploads/{{ villa.get_images_list()[3] }}" alt="Int√©rieur villa de luxe Marrakech - {{ villa.location }} - Pi√®ce principale">
                    </div>
                    {% endif %}
                    {% if villa.get_images_list()|length > 4 %}
                    <div class="triple-img-small">
                        <img src="/static/uploads/{{ villa.get_images_list()[4] }}" alt="D√©tail villa de prestige Marrakech - {{ villa.bedrooms }} chambres - {{ villa.location }}">
                    </div>
                    {% endif %}
                    {% if villa.get_images_list()|length > 5 %}
                    <div class="triple-img-small">
                        <img src="/static/uploads/{{ villa.get_images_list()[5] }}" alt="Espace de vie villa luxueuse Marrakech - {{ villa.area }} m¬≤ - {{ villa.location }}">
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Section Cr√©ative: Pourquoi Choisir Cette Villa -->
    <section class="why-choose">
        <div class="container">
            <h2 class="section-title-center">Pourquoi Choisir Cette Villa ?</h2>
            <div class="why-grid">
                <div class="why-card">
                    <div class="why-icon">üåü</div>
                    <h3>Emplacement Premium</h3>
                    <p>Situ√©e √† {{ villa.location }}, dans l'un des quartiers les plus pris√©s de Marrakech</p>
                </div>
                <div class="why-card">
                    <div class="why-icon">üèóÔ∏è</div>
                    <h3>Architecture Moderne</h3>
                    <p>Design contemporain alliant luxe, confort et authenticit√© marocaine</p>
                </div>
                <div class="why-card">
                    <div class="why-icon">üíé</div>
                    <h3>Finitions Haut de Gamme</h3>
                    <p>Mat√©riaux nobles et √©quipements premium pour un confort optimal</p>
                </div>
                <div class="why-card">
                    <div class="why-icon">üå¥</div>
                    <h3>Espaces Ext√©rieurs</h3>
                    <p>Jardin paysager, terrasses et espaces de vie en plein air exceptionnels</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features avec Background Image -->
    {% if villa.features %}
    <section class="features-parallax" {% if villa.get_images_list()|length > 6 %}style="background-image: url('/static/uploads/{{ villa.get_images_list()[6] }}')"{% endif %}>
        <div class="parallax-overlay"></div>
        <div class="container">
            <h2 class="section-title-center white">Caract√©ristiques Principales</h2>
            <div class="features-modern-grid">
                <div class="feature-modern-card">
                    <div class="feature-icon-large">üè°</div>
                    <h3>√âquipements</h3>
                    <ul class="feature-list-clean">
                        {% for feature in villa.features.split('\n')[:6] %}
                        {% if feature.strip() %}
                        <li>{{ feature.strip() }}</li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                {% if villa.equipment %}
                <div class="feature-modern-card">
                    <div class="feature-icon-large">‚≠ê</div>
                    <h3>Confort Premium</h3>
                    <ul class="feature-list-clean">
                        {% for item in villa.equipment.split('\n')[:6] %}
                        {% if item.strip() %}
                        <li>{{ item.strip() }}</li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                {% if villa.investment_benefits %}
                <div class="feature-modern-card">
                    <div class="feature-icon-large">üíé</div>
                    <h3>Avantages</h3>
                    <ul class="feature-list-clean">
                        {% for benefit in villa.investment_benefits.split('\n')[:6] %}
                        {% if benefit.strip() %}
                        <li>{{ benefit.strip() }}</li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Galerie Photos Compl√®te -->
    {% if villa.get_images_list()|length > 6 %}
    <section class="gallery-modern">
        <div class="container">
            <h2 class="section-title-center">Galerie Photos</h2>
            <div class="gallery-masonry">
                {% for img in villa.get_images_list()[6:] %}
                <div class="gallery-item-modern">
                    <img src="/static/uploads/{{ img }}" alt="Villa √† vendre Marrakech {{ villa.location }} - Photo {{ loop.index + 6 }} - {{ villa.title }} - Immobilier de luxe">
                    <div class="gallery-hover">
                        <span class="zoom-icon">üîç</span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Contact Section avec Background Image -->
    <section class="contact-modern" id="contact" {% if villa.get_images_list()|length > 7 %}style="background-image: url('/static/uploads/{{ villa.get_images_list()[7] }}')"{% endif %}>
        <div class="contact-overlay"></div>
        <div class="container">
            <div class="contact-box">
                <h2>Int√©ress√© par cette Villa ?</h2>
                <p class="contact-subtitle">Contactez-nous d√®s aujourd'hui pour organiser une visite priv√©e</p>
                
                <div class="contact-methods">
                    {% if villa.contact_phone %}
                    <div class="contact-method">
                        <div class="contact-icon">üìû</div>
                        <div class="contact-details">
                            <span class="contact-label">T√©l√©phone</span>
                            <a href="tel:{{ villa.contact_phone }}">{{ villa.contact_phone }}</a>
                        </div>
                    </div>
                    {% endif %}
                    {% if villa.contact_email %}
                    <div class="contact-method">
                        <div class="contact-icon">‚úâÔ∏è</div>
                        <div class="contact-details">
                            <span class="contact-label">Email</span>
                            <a href="mailto:{{ villa.contact_email }}">{{ villa.contact_email }}</a>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                {% set whatsapp_number = villa.contact_phone.replace('+', '').replace(' ', '').replace('-', '') if villa.contact_phone else '' %}
                {% set site_url = request.url_root %}
                {% set whatsapp_message = "Bonjour, je souhaite prendre rendez-vous pour visiter la villa " ~ villa.title ~ " et obtenir plus d'informations. Lien: " ~ site_url %}
                
                <a href="https://wa.me/{{ whatsapp_number }}?text={{ whatsapp_message | urlencode }}" target="_blank" class="btn-contact-large">
                    üì± Prendre Rendez-vous sur WhatsApp
                </a>
            </div>
        </div>
    </section>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <span class="lightbox-close">&times;</span>
        <span class="lightbox-nav lightbox-prev">‚Äπ</span>
        <span class="lightbox-nav lightbox-next">‚Ä∫</span>
        <div class="lightbox-content">
            <img src="" alt="Villa de luxe √† vendre Marrakech - Photo agrandie" id="lightbox-img">
        </div>
    </div>

    <script>
        // Hero Slider (3 photos)
        let currentSlide = 0;
        const slides = document.querySelectorAll('.hero-slide');
        
        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            if (slides[index]) {
                slides[index].classList.add('active');
            }
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }
        
        if (slides.length > 1) {
            setInterval(nextSlide, 5000);
        }

        // Lightbox pour Galerie
        const galleryItems = document.querySelectorAll('.gallery-item-modern');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const allImages = Array.from(galleryItems).map(item => item.querySelector('img').src);
        let currentImageIndex = 0;

        galleryItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                openLightbox(index);
            });
        });

        function openLightbox(index) {
            currentImageIndex = index;
            lightboxImg.src = allImages[index];
            lightbox.classList.add('active');
        }

        function closeLightbox() {
            lightbox.classList.remove('active');
        }

        function showPrevImage() {
            currentImageIndex = (currentImageIndex - 1 + allImages.length) % allImages.length;
            lightboxImg.src = allImages[currentImageIndex];
        }

        function showNextImage() {
            currentImageIndex = (currentImageIndex + 1) % allImages.length;
            lightboxImg.src = allImages[currentImageIndex];
        }

        document.querySelector('.lightbox-close').addEventListener('click', closeLightbox);
        document.querySelector('.lightbox-prev').addEventListener('click', showPrevImage);
        document.querySelector('.lightbox-next').addEventListener('click', showNextImage);
        
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) closeLightbox();
        });

        document.addEventListener('keydown', (e) => {
            if (!lightbox.classList.contains('active')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') showPrevImage();
            if (e.key === 'ArrowRight') showNextImage();
        });

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>

    {% else %}
    <div class="empty-state">
        <h1>Aucune Villa Disponible</h1>
        <p>Les informations de la villa ne sont pas encore configur√©es.</p>
        <a href="/login" class="btn-admin">Acc√©der √† l'administration</a>
    </div>
    {% endif %}
</body>
</html>
